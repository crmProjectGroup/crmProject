String khlb = record_new.get("khlb")==null?"":record_new.get("khlb")+"";//客户类别
String khid = record_new.get("id")==null?"":record_new.get("id")+"";//客户ID
String khdj = "";//客户等级


String sfgzzlcb = record_new.get("sfgzzlcb")==null?"":record_new.get("sfgzzlcb")+"";//关注综合成本
String qyztmc = record_new.get("gmqc")==null?"":record_new.get("gmqc")+"";//签约主体
String qyqc = record_new.get("qyqc")==null?"":record_new.get("qyqc")+"";//企业全称
String xbgdz = record_new.get("xbgdz")==null?"":record_new.get("xbgdz")+"";//现办公地址
String gsgm = record_new.get("gsgm")==null?"":record_new.get("gsgm")+"";//公司规模
String dbjp = record_new.get("dbjp")==null?"":record_new.get("dbjp")+"";//对比竞品
String kxwt= record_new.get("kxwt")==null?"":record_new.get("kxwt")+"";//抗性问题（销售）
String zlkxwt= record_new.get("zlkxwt")==null?"":record_new.get("zlkxwt")+"";//抗性问题（租赁）

String xqmj= record_new.get("xqmj")==null?"":record_new.get("xqmj")+"";//需求面积
String gmyy= record_new.get("gmyy")==null?"":record_new.get("gmyy")+"";//购买原因
String sfjxzsm = record_new.get("sfjxzsm")==null?"":record_new.get("sfjxzsm")+"";//是否进线转上门
String spmqsdfh= record_new.get("spmqsdfh")==null?"":record_new.get("spmqsdfh")+"";//是否明确锁定房号 公寓
String spphzx= record_new.get("spphzx")==null?"":record_new.get("spphzx")+"";//是否配合征信
String spqtyhtj= record_new.get("spqtyhtj")==null?"":record_new.get("spqtyhtj")+"";//是否洽谈优惠条件
String spjcrsm= record_new.get("spjcrsm")==null?"":record_new.get("spjcrsm")+"";//是否决策人上门
String sptlfkfs= record_new.get("sptlfkfs")==null?"":record_new.get("sptlfkfs")+"";//是否讨论付款方式 / 公寓
String zlyy= record_new.get("zlyy")==null?"":record_new.get("zlyy")+"";//租赁原因
String spfhys= record_new.get("spfhys")==null?"":record_new.get("spfhys")+"";//是否符合预算
String spmqsyrq= record_new.get("spmqsyrq")==null?"":record_new.get("spmqsyrq")+"";//是否明确使用日期
String spjczqzygyn= record_new.get("spjczqzygyn")==null?"":record_new.get("spjczqzygyn")+"";//是否决策周期在1个月内
String spqthtxj= record_new.get("spqthtxj")==null?"":record_new.get("spqthtxj")+"";//是否洽谈合同细节
String khtzjl = record_new.get("khtzjl")==null?"":record_new.get("khtzjl")+"";//客户投资经历 (排除  住宅 和 暂未了解) / 公寓
String sdfh = record_new.get("sdfh")==null?"":record_new.get("sdfh")+""; // 锁定房号 / 公寓
String gmys_gy = record_new.get("gmys_gy")==null?"":record_new.get("gmys_gy")+""; // 购买因素(公寓)
String zlrkd = record_new.get("zlrkd")==null?"":record_new.get("zlrkd")+""; // 认可点 公寓
String jllx = record_new.get("recordtype")==null?"":record_new.get("recordtype")+"";//记录类型

double pjzdlbcd=0.0; // 定级分数 (未使用)
double bwksl=0.0; // 存储定级分数
 List<CCObject> khpjpzlist=new ArrayList<CCObject>();
if("2018496272C934EtLhWs".equals(jllx)){  // 销售客户
     
  if(qyqc.length()>0){
     bwksl +=1.0;
  }
 if(gsgm.length()>0 && !gsgm.equals("暂未了解")){
     bwksl +=1.0;
  }
 if(dbjp.length()>0 && !dbjp.equals("暂未了解")){
     bwksl +=1.0;
  }
 if(kxwt.length()>0 && !kxwt.equals("暂未了解")){
     bwksl +=1.0;
  }
 if(xbgdz.length()>0){
     bwksl +=1.0;
  }
 if("是".equals(sfjxzsm)){
     bwksl +=1.0;
  }
 if(xqmj.length()>0){
     bwksl +=1.0;
  }
 if(gmyy.length()>0){
     bwksl +=1.0;
  }
 if("是".equals(spqtyhtj)){
     bwksl +=1.0;
 }
 if("是".equals(spmqsdfh)){
     bwksl +=1.0;
  }
 if("是".equals(spphzx)){
     bwksl +=1.0;
  }
 if("是".equals(spjcrsm)){
     bwksl +=1.0;
  }
 if("是".equals(sptlfkfs)){
     bwksl +=1.0;
  }
if(qyztmc.length()>0){
     bwksl +=1.0;
  }
  if((bwksl/14.0)>=0.8){
     khdj = "A";
   }else if((bwksl/14.0)>=0.5){
         khdj = "B";
     }else{
         khdj = "C";    
     }  
}else if("20186166515AE4A8ZfOc".equals(jllx)){  // 租赁客户

  if(qyqc.length()>0){
     bwksl +=1.0;
  }
 if(zlyy.length()>0){
     bwksl +=1.0;
  }
 if(dbjp.length()>0 && !dbjp.equals("暂未了解")){
     bwksl +=1.0;
  }
 if(zlkxwt.length()>0 && !zlkxwt.equals("暂未了解")){
     bwksl +=1.0;
  }
 if(xqmj.length()>0){
     bwksl +=1.0;
  }
 if("是".equals(spmqsdfh)){
     bwksl +=1.0;
  }
 if("是".equals(spqtyhtj)){
     bwksl +=1.0;
  }
 if("是".equals(spjcrsm)){
     bwksl +=1.0;
  }

if("是".equals(spqthtxj)){
     bwksl +=1.0;
  } 
if("是".equals(spjczqzygyn)){
     bwksl +=1.0;
  } 	 
if("是".equals(spmqsyrq)){
     bwksl +=1.0;
  }	
if("是".equals(sfgzzlcb)){
     bwksl +=1.0;
} 
if("是".equals(spfhys)){
     bwksl +=1.0;
  }	
if("是".equals(sfjxzsm)){
     bwksl +=1.0;
  }
if(qyztmc.length()>0){
     bwksl +=1.0;
  }	 
  if((bwksl/15.0)>=0.8){
     khdj = "A";
   }else if((bwksl/15.0)>=0.5){
         khdj = "B";
     }else{
         khdj = "C";    
     }	 	 	 	 
} else if ("2020F8FFFACC18DmPXQ1".equals(jllx)) { // 公寓类型的评级
    if ("是".equals(sptlfkfs)) {  // 是否讨论付款方式
        bwksl += 1.0;
    }
    
    if ((!"住宅;".equals(khtzjl)) && (!"住宅".equals(khtzjl)) && (!"暂未了解;".equals(khtzjl)) && (!"暂未了解".equals(khtzjl)) && (!"".equals(khtzjl))) { // 客户投资经历
        bwksl += 1.0;
    }
    
    if (("是".equals(spmqsdfh)) && (!"".equals(sdfh))) { // 是否明确锁定房号 和 锁定房号
        bwksl += 1.0;
    }
    
    if ((!"".equals(gmys_gy)) && (!"暂未了解;".equals(gmys_gy)) && (!"暂未了解".equals(gmys_gy))) { // 购买因素
        bwksl += 1.0;
    }
    
    if ((!"".equals(zlrkd)) && (!"暂未了解;".equals(zlrkd)) && (!"暂未了解".equals(zlrkd))) { //认可点
        bwksl += 1.0;
    }
    
    if (bwksl >= 3) {
        khdj = "A";
    } else if (0 < bwksl && bwksl < 3) {
        khdj = "B";
    } else {
        khdj = "C";
    } 
} else if ("2021A6974399AE59RKpF".equals(jllx)) { // 20210510 新增公寓布局设置级别
// 填写16大类及以上，且诚意登记情况必须有填写，为A类客户；
// 填写12大类及以上，但不足16大类，为B类客户；
// 填写10大类及以上，但不足12大类，为C类客户；
// 填写不足10大类，为D类客户
    boolean cydj = false;
    String age = record_new.get("age")==null?"":record_new.get("age")+"";//年龄
    String familyStructure = record_new.get("familyStructure")==null?"":record_new.get("familyStructure")+"";//家庭结构
    String gyClientType = record_new.get("gyClientType")==null?"":record_new.get("gyClientType")+"";//客户类型
    String xjzxq = record_new.get("xjzxq")==null?"":record_new.get("xjzxq")+"";//居住区域--现居住小区
    String ybgqy = record_new.get("ybgqy")==null?"":record_new.get("ybgqy")+"";//工作区域--主要事业所在地
    String lfcs = record_new.get("lfcs")==null?"":record_new.get("lfcs")+"";//来访次数
    String gjfk = record_new.get("gjfk")==null?"":record_new.get("gjfk")+"";//跟进反馈
    String gyNewCoChannel = record_new.get("gyNewCoChannel")==null?"":record_new.get("gyNewCoChannel")+"";//认知途径3
        if (!"".equals(age)) { // 年龄
            bwksl += 1.0;
        }
        if (!"".equals(familyStructure)) { // 家庭结构
            bwksl += 1.0;
        }
        if (!"".equals(gyClientType)) { // 客户类型
            bwksl += 1.0;
        }
        if (!"".equals(xjzxq)) { // 居住区域--现居住小区
            bwksl += 1.0;
        }
        if (!"".equals(ybgqy)) { // 工作区域--主要事业所在地
            bwksl += 1.0;
        }
        if (!"".equals(lfcs)) { // 来访次数
            bwksl += 1.0;
        }
        if (!"".equals(gjfk)) { // 跟进反馈
            bwksl += 1.0;
        }
        if (!"".equals(gyNewCoChannel)) { // 认知途径3
            bwksl += 1.0;
        }
    String yzkhqk = record_new.get("yzkhqk")==null?"":record_new.get("yzkhqk")+"";//诚意登记情况
        if (!"".equals(yzkhqk)) { // 诚意登记情况
            bwksl += 1.0;
            cydj = true;
        }

    String jzqy = record_new.get("jzqy")==null?"":record_new.get("jzqy")+"";//具体居住区域
    String jzdd = record_new.get("jzdd")==null?"":record_new.get("jzdd")+"";//具体居住地点
    String jzqybz = record_new.get("jzqybz")==null?"":record_new.get("jzqybz")+"";//具体居住备注
        if ((!"".equals(jzqy)) || (!"".equals(jzdd)) || (!"".equals(jzqybz))) { // 具体居住
            bwksl += 1.0;
        }

    String gzqy = record_new.get("gzqy")==null?"":record_new.get("gzqy")+"";//具体工作区域
    String gzdd = record_new.get("gzdd")==null?"":record_new.get("gzdd")+"";//具体工作地点
    String gzqybz = record_new.get("gzqybz")==null?"":record_new.get("gzqybz")+"";//具体工作备注
        if ((!"".equals(gzqy)) || (!"".equals(gzdd)) || (!"".equals(gzqybz))) { // 具体工作
            bwksl += 1.0;
        }

    String cshy = record_new.get("cshy")==null?"":record_new.get("cshy")+"";// 从事行业
    String gzcpmjd = record_new.get("gzcpmjd")==null?"":record_new.get("gzcpmjd")+"";// 关注产品面积段
    String lcyx = record_new.get("lcyx")==null?"":record_new.get("lcyx")+"";// 楼层意向
    String zymd = record_new.get("zymd")==null?"":record_new.get("zymd")+"";// 置业目的
    String gyResistance = record_new.get("gyResistance")==null?"":record_new.get("gyResistance")+"";// 抗性点公寓
    String sfgzwlxx = record_new.get("sfgzwlxx")==null?"":record_new.get("sfgzwlxx")+"";// 是否关注未来
    String gyProActiv = record_new.get("gyProActiv")==null?"":record_new.get("gyProActiv")+"";// 是否有兴趣参与项目举办的暖场活动
        if (!"".equals(cshy)) { // 从事行业
            bwksl += 1.0;
        }
        if (!"".equals(gzcpmjd)) { // 关注产品面积段
            bwksl += 1.0;
        }
        if (!"".equals(lcyx)) { // 楼层意向
            bwksl += 1.0;
        }
        if (!"".equals(zymd)) { // 置业目的
            bwksl += 1.0;
        }
        if (!"".equals(gyResistance)) { // 抗性点公寓
            bwksl += 1.0;
        }
        if (!"".equals(sfgzwlxx)) { // 是否关注未来
            bwksl += 1.0;
        }
        if (!"".equals(gyProActiv)) { // 是否有兴趣参与项目举办的暖场活动
            bwksl += 1.0;
        }

    String rtdian = record_new.get("rtdian")==null?"":record_new.get("rtdian")+"";// 认同点(价值)
    String rentongdian = record_new.get("rentongdian")==null?"":record_new.get("rentongdian")+"";// 认同点
    if ((!"".equals(rtdian)) || (!"".equals(rentongdian))) { // 认同点(价值)  认同点
        bwksl += 1.0;
    }
    
// 设置级别
// 填写16大类及以上，且诚意登记情况必须有填写，为A类客户；
// 填写12大类及以上，但不足16大类，为B类客户；
// 填写10大类及以上，但不足12大类，为C类客户；
// 填写不足10大类，为D类客户
    if (bwksl >= 16 && cydj) {
        khdj = "A";
    } else if (12 <= bwksl) {
        khdj = "B";
    } else if (10 <= bwksl && bwksl < 12){
        khdj = "C";
    } else {
        khdj = "D";
    }
    
}
 record_new.put("khdj",khdj);